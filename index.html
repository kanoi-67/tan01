<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é«˜æ ¡å…¥è©¦è‹±å˜èªã‚¯ã‚¤ã‚º</title>
  <style>
    body {
      font-family: "Arial", sans-serif;
      text-align: center;
      padding: 20px;
      background: #fdf6ec;
      color: #333;
    }
    h1 { font-size: 2.4rem; margin-bottom: 20px; }
    #quiz-container { font-size: 2rem; margin-top: 20px; }
    button {
      display: block;
      margin: 10px auto;
      font-size: 1.8rem;
      padding: 15px 25px;
      border: none;
      border-radius: 12px;
      background: #6fb3f2;
      color: white;
      cursor: pointer;
      width: 80%;
      max-width: 400px;
    }
    button:hover { background: #5aa3e6; }
    #timer { font-size: 2rem; margin: 15px; }
    #result-container { font-size: 1.8rem; margin-top: 30px; }
    .small { font-size: 1.4rem; color: #555; }
  </style>
</head>
<body>

  <h1>é«˜æ ¡å…¥è©¦è‹±å˜èªã‚¯ã‚¤ã‚º</h1>

  <div id="top-screen">
    <p style="font-size:1.8rem;">3åˆ†é–“ã§ã§ãã‚‹ã ã‘å¤šãæ­£è§£ã—ã‚ˆã†ï¼</p>
    <button id="start-btn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    <div id="stats" class="small"></div>
  </div>

  <div id="quiz-container" style="display:none;">
    <div id="timer">æ®‹ã‚Šæ™‚é–“: 3:00</div>
    <div id="question"></div>
    <div id="choices"></div>
  </div>

  <div id="result-container" style="display:none;"></div>

  <script>
    const questions = [
      { word: "apple", answer: "ã‚Šã‚“ã”" }, { word: "study", answer: "å‹‰å¼·ã™ã‚‹" },
      { word: "beautiful", answer: "ç¾ã—ã„" }, { word: "difficult", answer: "é›£ã—ã„" },
      { word: "easy", answer: "ã‚„ã•ã—ã„" }, { word: "family", answer: "å®¶æ—" },
      { word: "happy", answer: "å¹¸ã›ãª" }, { word: "music", answer: "éŸ³æ¥½" },
      { word: "school", answer: "å­¦æ ¡" }, { word: "teacher", answer: "å…ˆç”Ÿ" },
      { word: "dog", answer: "çŠ¬" }, { word: "cat", answer: "çŒ«" }, { word: "bird", answer: "é³¥" },
      { word: "mountain", answer: "å±±" }, { word: "river", answer: "å·" }, { word: "sea", answer: "æµ·" },
      { word: "car", answer: "è»Š" }, { word: "bus", answer: "ãƒã‚¹" }, { word: "train", answer: "é›»è»Š" },
      { word: "walk", answer: "æ­©ã" }, { word: "run", answer: "èµ°ã‚‹" }, { word: "swim", answer: "æ³³ã" },
      { word: "read", answer: "èª­ã‚€" }, { word: "write", answer: "æ›¸ã" }, { word: "speak", answer: "è©±ã™" },
      { word: "listen", answer: "èã" }, { word: "see", answer: "è¦‹ã‚‹" }, { word: "eat", answer: "é£Ÿã¹ã‚‹" },
      { word: "drink", answer: "é£²ã‚€" }, { word: "sleep", answer: "çœ ã‚‹" }, { word: "friend", answer: "å‹é”" },
      { word: "city", answer: "éƒ½å¸‚" }, { word: "country", answer: "å›½" }, { word: "morning", answer: "æœ" },
      { word: "night", answer: "å¤œ" }, { word: "day", answer: "æ—¥" }, { word: "time", answer: "æ™‚é–“" },
      { word: "book", answer: "æœ¬" }, { word: "pen", answer: "ãƒšãƒ³" }, { word: "desk", answer: "æœº" },
      { word: "chair", answer: "ã„ã™" }, { word: "door", answer: "ãƒ‰ã‚¢" }, { word: "window", answer: "çª“" },
      { word: "flower", answer: "èŠ±" }, { word: "tree", answer: "æœ¨" }, { word: "grass", answer: "è‰" },
      { word: "rain", answer: "é›¨" }, { word: "snow", answer: "é›ª" }, { word: "wind", answer: "é¢¨" },
      { word: "sun", answer: "å¤ªé™½" }, { word: "moon", answer: "æœˆ" }, { word: "star", answer: "æ˜Ÿ" },
      { word: "warm", answer: "ã‚ãŸãŸã‹ã„" }, { word: "cold", answer: "å¯’ã„" }, { word: "hot", answer: "æš‘ã„" },
      { word: "new", answer: "æ–°ã—ã„" }, { word: "old", answer: "å¤ã„" }, { word: "big", answer: "å¤§ãã„" },
      { word: "small", answer: "å°ã•ã„" }, { word: "long", answer: "é•·ã„" }, { word: "short", answer: "çŸ­ã„" },
      { word: "good", answer: "è‰¯ã„" }, { word: "bad", answer: "æ‚ªã„" }, { word: "kind", answer: "è¦ªåˆ‡ãª" },
      { word: "strong", answer: "å¼·ã„" }, { word: "weak", answer: "å¼±ã„" }, { word: "fast", answer: "é€Ÿã„" },
      { word: "slow", answer: "é…ã„" }, { word: "clean", answer: "ãã‚Œã„ãª" }, { word: "dirty", answer: "æ±šã„" },
      { word: "open", answer: "é–‹ã‘ã‚‹" }, { word: "close", answer: "é–‰ã‚ã‚‹" }, { word: "buy", answer: "è²·ã†" },
      { word: "use", answer: "ä½¿ã†" }, { word: "make", answer: "ä½œã‚‹" }, { word: "play", answer: "éŠã¶" },
      { word: "laugh", answer: "ç¬‘ã†" }, { word: "cry", answer: "æ³£ã" }, { word: "help", answer: "åŠ©ã‘ã‚‹" },
      { word: "study", answer: "å‹‰å¼·ã™ã‚‹" }, { word: "travel", answer: "æ—…è¡Œã™ã‚‹" },
      { word: "understand", answer: "ç†è§£ã™ã‚‹" }, { word: "remember", answer: "è¦šãˆã¦ã„ã‚‹" },
      { word: "forget", answer: "å¿˜ã‚Œã‚‹" }, { word: "love", answer: "æ„›ã™ã‚‹" }, { word: "like", answer: "å¥½ã" },
      { word: "hate", answer: "å«Œã†" }, { word: "hope", answer: "æœ›ã‚€" }, { word: "know", answer: "çŸ¥ã‚‹" },
      { word: "think", answer: "è€ƒãˆã‚‹" }, { word: "believe", answer: "ä¿¡ã˜ã‚‹" }, { word: "smile", answer: "ã»ã»ãˆã‚€" },
      { word: "question", answer: "è³ªå•" }, { word: "answer", answer: "ç­”ãˆ" }, { word: "story", answer: "ç‰©èª" },
      { word: "movie", answer: "æ˜ ç”»" }, { word: "game", answer: "ã‚²ãƒ¼ãƒ " }, { word: "sport", answer: "ã‚¹ãƒãƒ¼ãƒ„" },
      { word: "music", answer: "éŸ³æ¥½" }, { word: "song", answer: "æ­Œ" }, { word: "picture", answer: "çµµ" },
      { word: "letter", answer: "æ‰‹ç´™" }
    ];

    const topScreen = document.getElementById("top-screen");
    const quizContainer = document.getElementById("quiz-container");
    const resultContainer = document.getElementById("result-container");
    const timerEl = document.getElementById("timer");
    const questionEl = document.getElementById("question");
    const choicesEl = document.getElementById("choices");
    const statsEl = document.getElementById("stats");

    let timer, timeLeft, currentIndex, score, shuffledQuestions;

    function startQuiz() {
      topScreen.style.display = "none";
      resultContainer.style.display = "none";
      quizContainer.style.display = "block";
      score = 0;
      currentIndex = 0;
      timeLeft = 180;
      shuffledQuestions = [...questions].sort(() => Math.random() - 0.5);
      showQuestion();
      startTimer();
    }

    function startTimer() {
      updateTimerDisplay();
      timer = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        if (timeLeft <= 0) endQuiz();
      }, 1000);
    }

    function updateTimerDisplay() {
      const min = Math.floor(timeLeft / 60);
      const sec = timeLeft % 60;
      timerEl.textContent = `æ®‹ã‚Šæ™‚é–“: ${min}:${sec.toString().padStart(2, "0")}`;
    }

    function showQuestion() {
      if (currentIndex >= shuffledQuestions.length) return endQuiz();
      const q = shuffledQuestions[currentIndex];
      const wrongChoices = [...questions]
        .filter(x => x.answer !== q.answer)
        .sort(() => Math.random() - 0.5)
        .slice(0, 3)
        .map(x => x.answer);
      const allChoices = [q.answer, ...wrongChoices].sort(() => Math.random() - 0.5);
      questionEl.textContent = `${currentIndex + 1}. ${q.word}`;
      choicesEl.innerHTML = "";
      allChoices.forEach(choice => {
        const btn = document.createElement("button");
        btn.textContent = choice;
        btn.onclick = () => handleAnswer(choice === q.answer);
        choicesEl.appendChild(btn);
      });
    }

    function handleAnswer(correct) {
      if (correct) score++;
      currentIndex++;
      showQuestion();
    }

    function endQuiz() {
      clearInterval(timer);
      quizContainer.style.display = "none";
      resultContainer.style.display = "block";

      // ç´¯è¨ˆãƒ—ãƒ¬ã‚¤å›æ•°
      let total = parseInt(localStorage.getItem("playCount") || "0") + 1;
      localStorage.setItem("playCount", total);

      // ãƒ™ã‚¹ãƒˆ3ä¿å­˜
      const now = new Date();
      const formatted = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,"0")}-${String(now.getDate()).padStart(2,"0")} ${String(now.getHours()).padStart(2,"0")}:${String(now.getMinutes()).padStart(2,"0")}`;
      const record = { score, date: formatted };
      let best = JSON.parse(localStorage.getItem("bestScores") || "[]");
      best.push(record);
      best.sort((a,b) => b.score - a.score);
      best = best.slice(0,3);
      localStorage.setItem("bestScores", JSON.stringify(best));

      const messages = ["ã‚ˆãé ‘å¼µã‚Šã¾ã—ãŸï¼","é›†ä¸­åŠ›ãŒç´ æ™´ã‚‰ã—ã„ï¼","ç¶™ç¶šã¯åŠ›ãªã‚Šï¼","ç¢ºå®Ÿã«åŠ›ãŒã¤ã„ã¦ã„ã¾ã™ï¼"];
      const msg = messages[Math.floor(Math.random()*messages.length)];

      let bestText = "ğŸ† ã‚ãªãŸã®ãƒ™ã‚¹ãƒˆ3\n";
      best.forEach((b,i)=>{
        bestText += `${i+1}ä½ï¼š${b.score}å•ï¼ˆ${b.date}ï¼‰\n`;
      });

      resultContainer.innerHTML = `
        <p>â° æ™‚é–“åˆ‡ã‚Œï¼</p>
        <p>ä»Šå›ã®æ­£è§£æ•°ï¼š${score}å•</p>
        <p>${msg}</p>
        <pre style="text-align:left; margin:10px auto; display:inline-block;">${bestText}</pre>
        <p class="small">ç´¯è¨ˆãƒ—ãƒ¬ã‚¤å›æ•°ï¼š${total}å›</p>
        <button onclick="startQuiz()">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦</button>
        <button onclick="goHome()">ãƒˆãƒƒãƒ—ç”»é¢ã«æˆ»ã‚‹</button>
      `;
    }

    function goHome() {
      resultContainer.style.display = "none";
      topScreen.style.display = "block";
      updateStats();
    }

    function updateStats() {
      const total = localStorage.getItem("playCount") || 0;
      const best = JSON.parse(localStorage.getItem("bestScores") || "[]");
      let text = `ç´¯è¨ˆãƒ—ãƒ¬ã‚¤å›æ•°ï¼š${total}å›<br>`;
      if (best.length > 0) {
        text += "æœ€é«˜è¨˜éŒ²ï¼š" + best[0].score + "å•ï¼ˆ" + best[0].date + "ï¼‰";
      }
      statsEl.innerHTML = text;
    }

    document.getElementById("start-btn").addEventListener("click", startQuiz);
    updateStats();
  </script>
</body>
</html>
